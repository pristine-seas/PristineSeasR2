% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/crw_dhw.R
\name{get_crw_dhw_sf}
\alias{get_crw_dhw_sf}
\title{Fetch NOAA CRW DHW for an \code{sf} feature's bounding box}
\usage{
get_crw_dhw_sf(
  feature,
  start = "2015-01-01",
  end = "2024-12-31",
  name_col = "atoll",
  out_col = "feature",
  summarise_daily = TRUE,
  timeout_sec = 300,
  pause_sec = 0.2,
  verbose = TRUE
)
}
\arguments{
\item{feature}{A single-row \code{sf} object (one feature geometry).}

\item{start, end}{Date range (YYYY-MM-DD or Date).}

\item{name_col}{Name of the column in \code{feature} that holds the feature identifier.
This column can have any name (e.g., \code{"atoll"}, \code{"name"}, \code{"site"}, \code{"reef"}, \code{"id"}).}

\item{out_col}{Name of the output column used to store the feature identifier.
Default is \code{"feature"}. Set to \code{"atoll"} if you want an \code{atoll} column.}

\item{summarise_daily}{If TRUE (default), return daily mean DHW for the bbox.
If FALSE, return raw gridded DHW values for the bbox.}

\item{timeout_sec}{Request timeout (seconds).}

\item{pause_sec}{Pause between yearly requests (seconds).}

\item{verbose}{If TRUE, prints progress messages (feature + year).}
}
\value{
If \code{summarise_daily = TRUE}: tibble with columns \code{{out_col}}, \code{date}, \code{avg_dhw}.
If \code{summarise_daily = FALSE}: tibble with columns \code{{out_col}}, \code{date}, \code{latitude},
\code{longitude}, \code{dhw}.
}
\description{
Convenience wrapper that:
\enumerate{
\item transforms the feature geometry to WGS84 (EPSG:4326),
\item extracts its bounding box (xmin/xmax = lon, ymin/ymax = lat), and
\item queries CRW DHW in yearly chunks via \code{\link[=get_crw_dhw_bbox]{get_crw_dhw_bbox()}}.
}
}
\details{
By default, returns a \strong{daily mean DHW} across all grid points in the bbox.
Set \code{summarise_daily = FALSE} to return raw gridded values (one row per grid
cell per day).
}
\examples{
\dontrun{
# AOIs is an sf object with a column identifying each feature.
# The identifier column does NOT need to be named "atoll".

# ---- Example: single feature ----
jemo <- AOIs[AOIs$name == "Jemo", ]

jemo_dhw <- get_crw_dhw_sf(
  jemo,
  start = "2015-01-01", end = "2024-12-31",
  name_col = "name",
  out_col  = "feature"
)

# ---- Example: two features ----
subset <- AOIs[AOIs$name \%in\% c("Jemo", "Taka"), ]

dhw_two <- purrr::map_dfr(seq_len(nrow(subset)), \(i)
  get_crw_dhw_sf(
    subset[i, ],
    start = "2015-01-01", end = "2024-12-31",
    name_col = "name",
    out_col  = "feature"
  )
)
}

}
