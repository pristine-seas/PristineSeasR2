% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/clean_field_names.R
\name{clean_field_names}
\alias{clean_field_names}
\title{Clean Taxonomic Field Names from Benthic LPI Surveys}
\usage{
clean_field_names(x, return_log = FALSE, auto_approve = FALSE)
}
\arguments{
\item{x}{Character vector of taxonomic names to clean}

\item{return_log}{Logical. If \code{TRUE}, returns a list with both cleaned names
and a data frame logging all changes. If \code{FALSE} (default), returns only
the cleaned character vector. Default: \code{FALSE}}

\item{auto_approve}{Logical. If \code{TRUE}, applies all cleaning steps without
interactive prompts. Use with caution - recommended only after reviewing
changes with \code{auto_approve = FALSE} first. Default: \code{FALSE}}
}
\value{
If \code{return_log = FALSE} (default): A character vector of cleaned taxonomic names,
with \code{NA} for entries that were completely removed.

If \code{return_log = TRUE}: A list with two elements:
\describe{
\item{cleaned}{Character vector of cleaned taxonomic names}
\item{log}{Data frame with columns \code{step}, \code{original}, \code{cleaned}, and \code{rule}
documenting all changes made}
}
}
\description{
Interactively cleans and standardizes taxonomic names from benthic Line Point
Intercept (LPI) surveys. The function processes names through multiple cleaning
steps, asking for user approval at each stage to prevent unintended data loss.

This function is specifically designed for marine benthic taxonomy and implements
rules for handling taxonomic uncertainty markers, species-level
designations, and common field survey artifacts.
}
\details{
\subsection{Cleaning Steps}{

The function applies the following transformations in sequence:
\subsection{1. Remove Parentheses and Quotes}{

Removes content in parentheses and quotation marks (including nested):
\itemize{
\item \code{Pocillopora (damicornis)} → \code{Pocillopora}
\item \code{Pocillopora ((nested))} → \code{Pocillopora}
\item \verb{Turbinaria "mesenterina"} → \code{Turbinaria}
}
}

\subsection{2. Truncate at sp./spp.}{

Removes species-level uncertainty markers and keeps only genus:
\itemize{
\item \verb{Acropora sp.} → \code{Acropora}
\item \verb{Porites spp} → \code{Porites}
}

Pattern matching uses word boundaries to avoid truncating valid names
(e.g., "Dispar" is preserved).
}

\subsection{3. Handle Uncertainty Markers}{

\strong{aff. (affinis)} - Strong uncertainty, drops epithet:
\itemize{
\item \verb{Montipora aff. capitata} → \code{Montipora}
\item \verb{Montipora Aff. capitata} → \code{Montipora}
\item Indicates the specimen is similar to but likely not the named species
}

\strong{cf. (confer)} - Mild uncertainty, keeps epithet:
\itemize{
\item \verb{Porites cf. lobata} → \verb{Porites lobata}
\item Indicates comparison with named species, higher confidence
}
}

\subsection{4. Handle Unknown + Taxonomic Group}{

Converts "unknown" + group to proper higher taxonomy:
\itemize{
\item \verb{Unknown coral} → \code{Scleractinia}
\item \verb{Unknown sponge} → \code{Porifera}
\item \code{Unidentified} alone → \code{NA}
}
}

\subsection{5. Remove '-like' Qualifiers}{

Removes qualifiers indicating morphological similarity:
\itemize{
\item \code{Millepora-like} → \code{Millepora}
\item \verb{Millepora-like organism} → \code{Millepora}
\item Handles various dash types: \code{-}, \verb{–}, \verb{—}
}
}

\subsection{6. Standardize Capitalization}{

Converts to proper taxonomic case (genus capitalized, epithet lowercase):
\itemize{
\item \verb{ACROPORA PALMATA} → \verb{Acropora palmata}
\item \verb{porites lobata} → \verb{Porites lobata}
}
}

\subsection{7. Whitespace Cleanup}{

Removes extra spaces and trims leading/trailing whitespace
}

}

\subsection{Interactive Workflow}{

At each step, the function:
\enumerate{
\item Shows proposed changes with before/after comparison
\item Displays up to 20 examples (with count of additional changes)
\item Prompts for approval (y/n)
\item Applies changes only if approved
}

This interactive approach allows taxonomic experts to review each
transformation and ensure no valid taxonomic names are corrupted.
}
}
\examples{
# Basic usage with auto-approve
taxa <- c(
  "ACROPORA SP.",
  "Porites cf. lobata",
  "Montipora aff. capitata",
  "Pocillopora (damicornis)",
  "Unknown coral",
  "Millepora-like",
  "Stylophora  pistillata"
)

cleaned <- clean_field_names(taxa, auto_approve = TRUE)

# With logging for reproducibility
result <- clean_field_names(taxa, return_log = TRUE, auto_approve = TRUE)
cleaned_names <- result$cleaned
change_log <- result$log

\dontrun{
# Interactive mode (prompts for approval at each step)
cleaned_interactive <- clean_field_names(taxa)

# Export log for methods section
write.csv(change_log, "taxonomy_cleaning_log.csv", row.names = FALSE)

# Clean a data frame column
library(dplyr)
df <- data.frame(
  site = c("A", "B", "C"),
  taxon = c("Acropora sp.", "Porites cf. lutea", "Unknown")
)

df_clean <- df \%>\%
  mutate(taxon_clean = clean_field_names(taxon, auto_approve = TRUE))
}

}
\references{
Sigovini, M., Keppel, E., & Tagliapietra, D. (2016). Open Nomenclature in
the biodiversity era. \emph{Methods in Ecology and Evolution}, 7(10), 1217-1225.

Bengtson, P. (1988). Open nomenclature. \emph{Palaeontology}, 31, 223-227.
}
\author{
Juan Mayorga
}
